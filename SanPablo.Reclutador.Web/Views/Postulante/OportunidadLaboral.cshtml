@model SanPablo.Reclutador.Web.Models.OportunidadLaboralViewModel


@{
    ViewBag.Title = "Lista";
    Layout = "~/Views/Shared/_LayoutExtranet.cshtml";
}
@section Head{
    <link href="@Url.Content("~/Scripts/uploadify/uploadify.css")" rel="stylesheet" type="text/css" />
}

@section Scripts{

<script src="@Url.Content("~/Scripts/uploadify/swfobject.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/uploadify/jquery.uploadify.v2.1.4.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/SanPablo.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/Funciones.js")" type="text/javascript"></script>

    <script type="text/javascript">
        $(document).ready(function () {

            $("#txtfechainicio").datepicker();
            $("#txtfechafin").datepicker();

            jQuery("#grdListBuscarOportunidad").jqGrid({
                url: '@Url.Action("ListaOfertasLaborales", "Postulante")',
                datatype: 'json',
                mtype: 'POST',
                colNames: ['Fecha', 'Lugar', 'Cargo/Posición', 'Tipo', 'Fecha Expiración', 'Area', 'Postular'],
                colModel: [
                        { name: 'Fecha', index: 'Fecha', align: 'center', width: 80, sortable: false },
                        { name: 'Lugar', index: 'Lugar', align: 'left', width: 150, sortable: false },
                        { name: 'CargoPosicion', index: 'CargoPosicion', width: 180, align: 'left', sortable: false, formatter: DetalleCargoFormatter },
                        { name: 'Tipo', index: 'Tipo', align: 'center', sortable: false, width: 90 },
                        { name: 'FechaExpiracion', index: 'FechaExpiracion', align: 'center', sortable: false, width: 80},
                        { name: 'Area', index: 'Area', hidden: true, visible: false, width: 80 },
                        { name: 'Postular', index: 'Postular', align: 'center', sortable: false, width: 40, formatter: PostularFormatter }
                ],
                pager: jQuery('#grdPagerBuscarOportunidad'),
                rowNum: 10,
                rowList: [10, 30, 50],
                sortname: 'Fecha',
                sortorder: 'desc',
                viewrecords: true,
                height: 320,
                width: 850,
                rowNum: 0,
                cellsubmit: 'clientArray',
                hidegrid: false,
                postData: {

                },
                loadComplete: function (data) {
                    if (data != null) {
                        if (data.rows.length > 0) {
                            var cRows = data.rows.length;
                            for (iRow = 0; iRow <= cRows; iRow++) {
                                //jQuery("#grdList").setCell(iRow, 2, '', { background: '#c7c5c5' });
                            }
                        }
                    }

                },
                grouping: true,
                groupingView: {
                    groupField: ['Area'],
                    groupDataSorted: true
                }
            });


            $("#dialogconfirm1").dialog({
                autoOpen: false,
                resizable: false,
                height: 180,
                modal: true,
                buttons: {
                    "Aceptar": function () {
                        //grabar(); /*return true;*/
                        $(this).dialog("close");
                    },
                    "Cancelar": function () {
                        $(this).dialog("close");
                    }
                }
            });

        });

        function DetalleCargoFormatter(cellvalue, options, rowObject) {          
            var a = '<a href="@Url.Action("DetalleCargo", "Postulante")" style="color:blue;text-decoration:underline" >' + cellvalue + '</a>';
            return a;
        }

        function PostularFormatter(cellvalue, options, rowObject) {
            var imgPath = '@Url.Content("~/Content/images/")';
            var archivo = 'right_2.png';
            var strImg = '<img onclick="confirmapostulacion()" src="' + imgPath + archivo + '" width="16" height="16" title="Editar" alt="Editar">';
            return strImg;
        }

        function confirmapostulacion() {
            $("#dialogconfirm1").dialog("open");
        }
    
    </script>
}

<div class="row">
    <div class="span12">
        <div class="widget-box">
            <div class="widget-title">
                <h5>Oportunidades Laborales</h5>
            </div> 
            
@using (Html.BeginForm("Index", "OportunidadLaboral", FormMethod.Post, new { enctype = "multipart/form-data", id = "FormOportunidadLaboral" }))
{
    @Html.ValidationSummary(true)
    // <form class="formulario-busqueda">
        <table class="formulario-busqueda">
            <tr class="formulario-fila">
                <td class="span5">
                    <label class="control-label" for="inputSuccess">Lugar</label>
                    <div class="controles">
                        @Html.DropDownListFor(model => model.oportunidadLaboral.IdeSede, new SelectList(Model.listaSede, "Valor", "Descripcion", Model.oportunidadLaboral.IdeSede),new {  data_val = "false"})
                    </div>
                </td>

                <td class="span5">
                    <label class="control-label" for="selectError">Cargo</label>
                    <div class="controles">
                        @Html.DropDownListFor(model => model.oportunidadLaboral.IdeCargo, new SelectList(Model.listaCargos, "IdeCargo", "NombreCargo", Model.oportunidadLaboral.IdeCargo),new {  data_val = "false"})
                    </div> 
                </td>
            </tr>       
            <tr class="formulario-fila">
                <td class="span5">
                    <label class="control-label" for="inputSuccess">Tipo</label>
                   <div class="controles">
                        @Html.DropDownListFor(model => model.oportunidadLaboral.TipoHorario, new SelectList(Model.listaHorario, "Valor", "Descripcion", Model.oportunidadLaboral.TipoHorario),new {  data_val = "false"})
                    </div>
                </td>
                <td class="span5">
                    <label class="control-label" for="selectError">Fecha</label>
                    <div class="controles">
                        @*<input type="text" placeholder=" Inicial"  class="input-small" id="txtfechainicio"> -  <input type="text" placeholder=" Final" class="input-small" id="txtfechafin">*@

                           @Html.EditorFor(model => model.oportunidadLaboral.FecInicial, new { @class = "textoFormulario" ,  maxlength="15", placeholder=" Inicial"})      
                           @Html.EditorFor(model => model.oportunidadLaboral.FecFinal, new { @class = "textoFormulario" ,  maxlength="15", placeholder=" Final"})      
                    </div>
                </td>
            </tr>     
        </table>
}
        <div class="formulario-accion">
            <div class="opciones">
                <a class="btn btn-info" id="btnBuscarOportunidad"><i class="icon-search icon-white"></i> Buscar</a> 
            </div>
            </div>
        <div style="clear:both"></div>
            
        <div>
            <table id="grdListBuscarOportunidad">
            </table>
            <div id="grdPagerBuscarOportunidad">
            </div>
        </div>
                                      
        </div>
    </div>
</div>

<div id="dialogconfirm1" title="Confirmación">
<p><span class="ui-icon ui-icon-info" style="float: left; margin: 0 7px 20px 0;"></span>Confirme que desea postular al cargo seleccionado</p>
</div>

